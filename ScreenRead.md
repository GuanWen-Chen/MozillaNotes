#ScreenReader
##Outline
##Introduction
###What is screen reader
**Web Accessibility Initiative-Accessible Reich Internet Application(WAI-ARIA)** is a w3c recommendation that can gain 
the accessibility to the disabilities. And screen reader is a text-to-voice software accessibility tool for mozilla.
###How to enable screen reader on B2G?

Open "Settings" >> choose "Developers" >> check "Show screen reader settings" under "debug"<br/>
Back to "Settings" mune >> choose "Accessibility" >> Open "Screen Reader"

##CodeFlow
(ref:https://bugzilla.mozilla.org/show_bug.cgi?id=1113494#c9)


- [Gaia] use mozSettings “accessibility.screenreader” to start [1]
- [Gecko-b2g] AccessFu.jsm inject content-script.js into all content processes
- [Gecko-content] content-script.js initialize EventManager, ContentControl, and all required accessibility API

- [Gecko-content] ContentControl capture mousemove events and move visual caret by vc.moveToPoint() [2]
- [Gecko-content] handle moveToPoint, move visual cursor to corresponding element.
- [Gecko-content] EventManager catch visual cursor change event and trigger Presentation.pivotChanged callback [3]
     - [Gecko-content] VisualPresenter.pivotChanged will create a corresponding pivot context ('vc-change') for moving highlighting indicator [4] 
     - [Gecko-content] B2GPresenter.pivotChanged will create a corresponding pivot context (‘vc-change’) for speech synthesis [5]
     - [Gecko-content] EventManager send AccessFu:Present with both pivot contexts

- [Gecko-b2g] AccessFu.jsm received AccessFu:Present message
     - [Gecko-b2g] use Output.Visual() to adjust highlighting indicator [6]
     - [Gecko-b2g] use Output.B2G() to forward speech synthesis data via mozChromeEvent [7]
- [Gaia] capture mozChromeEvent(‘accessibility-action’) 'vc-change’ type.
- [Gaia] build utterance and speech synthesis. [8]

Text for speech synthesis are generated by UtteranceGenerator according to element types. You may customize the generation rules. [9]
AccessFu uses PointerAdapter.jsm to capture touch gesture which overrides the input behavior. You might want to disable it. [10]

[1] https://github.com/mozilla-b2g/gaia/blob/master/apps/settings/js/panels/accessibility_screenreader/confirm_dialog.js#L23<br/>
[2] https://dxr.mozilla.org/mozilla-central/source/accessible/jsat/ContentControl.jsm#142<br/>
[3] https://dxr.mozilla.org/mozilla-central/source/accessible/jsat/EventManager.jsm#149<br/>
[4] https://dxr.mozilla.org/mozilla-central/source/accessible/jsat/Presentation.jsm#180<br/>
[5] https://dxr.mozilla.org/mozilla-central/source/accessible/jsat/Presentation.jsm#505<br/>
[6] https://dxr.mozilla.org/mozilla-central/source/accessible/jsat/AccessFu.jsm#531<br/>
[7] https://dxr.mozilla.org/mozilla-central/source/accessible/jsat/AccessFu.jsm#525<br/>
[8] https://github.com/mozilla-b2g/gaia/blob/master/apps/system/js/accessibility.js#L291<br/>
[9] https://dxr.mozilla.org/mozilla-central/source/accessible/jsat/OutputGenerator.jsm#304<br/>
[10] https://dxr.mozilla.org/mozilla-central/source/accessible/jsat/AccessFu.jsm#128<br/>

##Relative Bugs
